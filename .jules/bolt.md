## 2026-03-03 - [Optimize Environment Parent Pointer]
**Learning:** `Environment` was using `Weak` references for the `parent` pointer, requiring costly `upgrade()` calls on every variable lookup (`get`, `assign`, `has`). This was likely done to prevent reference cycles. However, scope chains are strictly hierarchical (Child -> Parent), and Parents do not hold strong references to Children (only the call stack or closures do). Since `Function` values hold `Weak` references to their defining `Environment`, changing `parent` to a strong `Rc` does not introduce cycles and significantly simplifies lookup logic.
**Action:** Changed `Environment.parent` to `Option<Rc<RefCell<Environment>>>`. This replaces `upgrade()` (check + construct) with `clone()` (increment) in hot paths. Always analyze ownership graphs before using `Weak` pointers "just in case".
