// Test Static File Serving Module

display "=== Testing Static File Serving ==="
display ""

// Create test directory and files
store test_dir as "test_public"

display "Setting up test environment..."

try:
    // Create directory
    check if directory exists at test_dir:
        display "  ✓ Test directory exists"
    otherwise:
        create directory at test_dir
        display "  ✓ Created test directory"
    end check

    // Create test HTML file
    store html_content as "<!DOCTYPE html>
<html>
<head>
    <title>Test Page</title>
</head>
<body>
    <h1>Static File Test</h1>
    <p>This HTML file was served by Weave!</p>
</body>
</html>"

    open file at test_dir with "/index.html" for writing as html_file
    write content html_content into html_file
    close file html_file
    display "  ✓ Created index.html"

    // Create test CSS file
    store css_content as "body {
    font-family: Arial, sans-serif;
    margin: 40px;
    color: #333;
}"

    open file at test_dir with "/style.css" for writing as css_file
    write content css_content into css_file
    close file css_file
    display "  ✓ Created style.css"

    // Create test JS file
    store js_content as "console.log('Static file serving works!');"

    open file at test_dir with "/app.js" for writing as js_file
    write content js_content into js_file
    close file js_file
    display "  ✓ Created app.js"

    // Create test JSON file
    store json_content as "{\"status\": \"ok\", \"test\": \"static files\"}"

    open file at test_dir with "/data.json" for writing as json_file
    write content json_content into json_file
    close file json_file
    display "  ✓ Created data.json"

catch:
    display "  ❌ Error setting up test files"
end try

display ""
display "✅ Test setup complete!"
display ""
display "To test the static file server:"
display "  1. Run a web server with this test directory"
display "  2. Visit http://localhost:PORT/index.html"
display "  3. Try http://localhost:PORT/style.css"
display "  4. Try http://localhost:PORT/app.js"
display "  5. Try http://localhost:PORT/data.json"
display ""
display "Security tests to try:"
display "  - http://localhost:PORT/../../../etc/passwd (should be blocked)"
display "  - http://localhost:PORT/.hidden (should be blocked)"
display ""
