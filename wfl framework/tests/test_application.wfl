// Test Application Bootstrap (without starting server)
display "=== WFL MVC Framework - Application Test ==="
display ""

// Load framework
display "Loading framework components..."
load module from "../core/application.wfl"
load module from "../middleware/cors.wfl"
load module from "../middleware/logging.wfl"
display "✓ Framework loaded"
display ""

// Test 1: Create Application
display "Test 1: Create Application"
create new Application as app:
    port_number is 8080
    host is "localhost"
    middleware_list is create list
    is_running is no
end

app.initialize()
display "✓ Application created"
display ""

// Test 2: Configure Port
display "Test 2: Configure Port"
app.set_port(3000)
display "✓ Port configured"
display ""

// Test 3: Add Middleware
display "Test 3: Add Middleware"

create new CorsMiddleware as cors:
    middleware_name is "CORS"
    enabled is yes
    allowed_origins is "*"
    allowed_methods is "GET,POST"
    allowed_headers is "Content-Type"
    max_age is 3600
end

create new LoggingMiddleware as logger:
    middleware_name is "Logger"
    enabled is yes
    log_file is "logs/test.log"
    log_format is "combined"
    request_count is 0
end

app.add_middleware(cors)
app.add_middleware(logger)

display "Middleware count: " with length of app.middleware_list
display "✓ Middleware registered"
display ""

// Test 4: Register Routes
display "Test 4: Register Routes"
app.add_route("GET", "/", "HomeController.index")
app.add_route("GET", "/api/users", "UserController.list")
app.add_route("POST", "/api/users", "UserController.create")
app.add_route("GET", "/api/status", "ApiController.status")
display "✓ Routes registered"
display ""

// Test 5: Check Status
display "Test 5: Check Application Status"
store app_status as app.get_status()
display "Application status: " with app_status
display "✓ Status check complete"
display ""

display "=== All Application Tests Passed! ==="
display ""
display "Note: To test with real HTTP server, run examples/simple_app.wfl"
display "      That will start a server on port 3000"
